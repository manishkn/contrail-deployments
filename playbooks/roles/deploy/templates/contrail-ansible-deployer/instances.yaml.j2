{% if provider_config is defined %}
provider_config:
  bms: 
{% for key, value in provider_config.bms.iteritems() %}    {{ key }}: {{ value }}
{% endfor %}
{% endif %}

{% if instances is defined %}
instances:
{% for key, value in instances.iteritems() %}  {{ key }}:
{% for k,v in value.iteritems() %} {% if 'roles' == k %}   {{ k }}:
{% for item in v %}      {{ item }}:
{% endfor %}
{% else %}   {{ k }}: {{ v }}
{% endif %}
{% endfor %}
{% endfor %}
{% endif %}

{% if contrail_configuration is defined %}
contrail_configuration:
{% for key, value in contrail_configuration.iteritems() %}  {{ key }}: {{ value }}
{% endfor %}
  CONTAINER_REGISTRY: {{ contrailregistry }}
  CONTRAIL_VERSION: {{ version }}-{{ 'centos7' if 'centos' in os else os }}-{{ sku }}
  CLOUD_ORCHESTRATOR: {{ orchestrator }} 
  CONTROLLER_NODES: {{ controller_nodes }}
  METADATA_PROXY_SECRET: {{ metadata_secret }}
{% if orchestrator == 'openstack' %}
  AUTH_MODE: keystone
  KEYSTONE_AUTH_ADMIN_PASSWORD: {{ admin_password }}
  KEYSTONE_AUTH_HOST: "{{ auth_ip }}"
  KEYSTONE_AUTH_URL_VERSION: "/{{ keystone_version }}"
  RABBITMQ_NODE_PORT: "{{ contrail_rabbitmq_port }}"
{% endif %}
{% endif %}
