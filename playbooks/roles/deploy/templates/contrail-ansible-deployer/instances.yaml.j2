
{% if provider_config is defined %}
provider_config:
  bms: 
{% for key, value in provider_config.bms.iteritems() %}    {{ key }}: {{ value }}
{% endfor %}
{% endif %}


{% if instances is defined %}
instances:
{% for key, value in instances.iteritems() %}  {{ key }}:
{% for k,v in value.iteritems() %} {% if 'roles' in k %}   {{ k }}:
{% for item in v %} {% if item == 'openstack' %} 
{% for v_item in ['openstack_control', 'openstack_network', 'openstack_storage', 'openstack_monitoring', 'openstack_compute'] %}      {{ v_item }}:
{% endfor %}
{% else %}     {{ item }}:  
{% endif %}
{% endfor %}
{% else %}   {{ k }}: {{ v }}
{% endif %}
{% endfor %}
{% endfor %}
{% endif %}

{% if contrail_configuration is defined %}
contrail_configuration:
  CONTAINER_REGISTRY: {{ contrailregistry }}
  CONTRAIL_VERSION: {{ version }}-{{ 'centos7' if 'centos' in os }}-{{ sku }}
  CLOUD_ORCHESTRATOR: {{ orchestrator }} 
  CONTROLLER_NODES: {{ controller_nodes }}
  RABBITMQ_PORT: {{ contrail_rabbitmq_port }}
{% endif %}

kolla_config:
  kolla_globals:
    kolla_internal_vip_address: {{ kolla_internal_vip_address }}
    kolla_external_vip_address: {{ kolla_external_vip }}
    contrail_api_interface_address: "{{ auth_ip }}"
    network_interface: "eth1"
    kolla_external_vip_interface: "eth1"
    enable_haproxy: "yes"

